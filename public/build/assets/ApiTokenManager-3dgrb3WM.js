import{r as c,K as E,m as p,j as e}from"./app-nUqQ7yHU.js";import{A as L}from"./ActionSection-Ly8BKCvG.js";import{F as M}from"./FormSection-BUCsG2SP.js";import{I as O}from"./InputError-Dxbi3bhu.js";import{B as n}from"./button-CZNwMcjW.js";import{C as T}from"./checkbox-BaS4xhTS.js";import{D as x,a as h,b as u,c as g,d as j,e as k}from"./dialog-z35dOSef.js";import{I as H}from"./input-BpRyKDf7.js";import{L as P}from"./label-DnNgpJC0.js";import{S as K}from"./separator-BB3MwsvO.js";import{t as f}from"./index-Ba2aNcjd.js";import{s as y}from"./index-DYrn6zHh.js";import"./utils-DdhcCPaC.js";import"./index-Ck7UmjVM.js";import"./index-jkSOGXlp.js";import"./index-NQIq8vXu.js";import"./index-0LLtFATr.js";import"./index-C86NnV09.js";import"./index-DGrkKgMT.js";import"./check-kCqOfe73.js";import"./createLucideIcon-BITYyA_o.js";import"./index-BidZMABv.js";import"./index-CYRNUmCa.js";import"./index-Q3TAqLyU.js";const R=[],U=[],Y=[],ue=c.memo(({tokens:b=R,availablePermissions:o=U,defaultPermissions:S=Y})=>{const[F,d]=c.useState(!1),[v,i]=c.useState(null),[N,l]=c.useState(null),A=E(),t=p({name:"",permissions:S}),a=p({permissions:[]}),C=p({}),w=()=>{t.post(y("api-tokens.store"),{preserveScroll:!0,onSuccess:()=>{d(!0),t.reset(),f.success("Token has been created")}})},I=s=>{a.setData("permissions",s.abilities),i(s)},B=()=>{a.put(y("api-tokens.update",v),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{i(null),f.success("Permissions have been updated")}})},_=s=>{l(s)},$=()=>{C.delete(y("api-tokens.destroy",N),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{l(null),f.success("Token has been deleted")}})},D=(s,r)=>s.includes(r);return e.jsxs("div",{children:[e.jsx(M,{onSubmit:w,title:"Create API Token",description:"API tokens allow third-party services to authenticate with our application on your behalf.",form:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-span-6 sm:col-span-4",children:[e.jsx(P,{htmlFor:"name",children:"Name"}),e.jsx(H,{id:"name",type:"text",value:t.data.name,onChange:s=>t.setData("name",s.target.value),className:"mt-1 block w-full",autoFocus:!0}),e.jsx(O,{message:t.errors.name,className:"mt-2"})]}),o.length>0&&e.jsxs("div",{className:"col-span-6",children:[e.jsx(P,{htmlFor:"permissions",children:"Permissions"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-4 md:grid-cols-2",children:o.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{id:`create-${s}`,checked:D(t.data.permissions,s),onCheckedChange:r=>{r?t.setData("permissions",[...t.data.permissions,s]):t.setData("permissions",t.data.permissions.filter(m=>m!==s))}}),e.jsx("label",{htmlFor:`create-${s}`,className:"text-sm font-medium leading-none text-gray-600 peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-gray-400",children:s})]},s))})]})]}),actions:e.jsx(n,{disabled:t.processing,children:"Create"})}),b.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"my-8 hidden sm:block"}),e.jsx("div",{className:"mt-10 sm:mt-0",children:e.jsx(L,{title:"Manage API Tokens",description:"You may delete any of your existing tokens if they are no longer needed.",content:e.jsx("div",{className:"space-y-6",children:b.map(s=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"break-all dark:text-white",children:s.name}),e.jsxs("div",{className:"ms-2 flex items-center",children:[s.last_used_ago&&e.jsxs("div",{className:"text-sm text-gray-400",children:["Last used"," ",s.last_used_ago]}),o.length>0&&e.jsx("button",{type:"button",className:"cursor-pointer ml-6 text-sm text-gray-400",onClick:()=>I(s),children:"Permissions"}),e.jsx("button",{type:"button",className:"cursor-pointer ml-6 text-sm text-red-500",onClick:()=>_(s),children:"Delete"})]})]},s.id))})})})]}),e.jsx(x,{open:F,onOpenChange:d,children:e.jsxs(h,{className:"sm:max-w-md",children:[e.jsxs(u,{children:[e.jsx(g,{children:"API Token"}),e.jsx(j,{children:"Please copy your new API token. For your security, it won't be shown again."})]}),A.props.jetstream.flash.token&&e.jsx("div",{className:"mt-4 break-all rounded bg-gray-100 px-4 py-2 font-mono text-sm text-gray-500 dark:bg-gray-900",children:A.props.jetstream.flash.token}),e.jsx(k,{children:e.jsx(n,{variant:"secondary",onClick:()=>d(!1),children:"Close"})})]})}),e.jsx(x,{open:v!==null,onOpenChange:s=>!s&&i(null),children:e.jsxs(h,{className:"sm:max-w-md",children:[e.jsxs(u,{children:[e.jsx(g,{children:"API Token Permissions"}),e.jsx(j,{children:"Update the permissions for this API token."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:o.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T,{id:`update-${s}`,checked:D(a.data.permissions,s),onCheckedChange:r=>{r?a.setData("permissions",[...a.data.permissions,s]):a.setData("permissions",a.data.permissions.filter(m=>m!==s))}}),e.jsx("label",{htmlFor:`update-${s}`,className:"text-sm font-medium leading-none text-gray-600 peer-disabled:cursor-not-allowed peer-disabled:opacity-70 dark:text-gray-400",children:s})]},s))}),e.jsxs(k,{children:[e.jsx(n,{variant:"secondary",onClick:()=>i(null),children:"Cancel"}),e.jsx(n,{className:"ms-3",disabled:a.processing,onClick:B,children:"Save"})]})]})}),e.jsx(x,{open:N!==null,onOpenChange:s=>!s&&l(null),children:e.jsxs(h,{children:[e.jsxs(u,{children:[e.jsx(g,{children:"Delete API Token"}),e.jsx(j,{children:"Are you sure you would like to delete this API token?"})]}),e.jsxs(k,{children:[e.jsx(n,{variant:"secondary",onClick:()=>l(null),children:"Cancel"}),e.jsx(n,{variant:"destructive",className:"ms-3",disabled:C.processing,onClick:$,children:"Delete"})]})]})})]})});export{ue as default};
